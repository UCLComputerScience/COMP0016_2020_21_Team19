{% extends 'base.html' %}

{% block sidebar %}
<li class="nav-item">
  <a class="nav-link" href="{% url 'dashboard' %}">
    <span data-feather="home"></span>
    Dashboard <span class="sr-only">(current)</span>
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="{% url 'leaderboard' %}">
    <span data-feather="bar-chart-2"></span>
    Leaderboard
  </a>
</li>
<li class="nav-item">
  <a class="nav-link active" href="{% url 'groups' %}">
    <span data-feather="bar-chart-2"></span>
    Groups <span class="sr-only">(current)</span>
  </a>
</li>
{% endblock %}

{% block content %}

<h2>Groups</h2>
<div> {# class="container" #}
  <table class="table table-striped table-hover">
      <thead class="thead">
        <tr>
            <th>Name</th>
            <th>Participants</th>
        </tr>
      </thead>
      <tbody id="table-body">
        {% for group in groups %}
  
        <tr onclick="document.location = '{% url 'manage_group' group.id %}';">
          <td class="align-middle">{{ group.name }}</td>
          <td class="align-middle">{{ group.num_participants }}</td>
          <td><button style="float: right" type="button" class="btn btn-outline-danger delete-group" data-group="{{ group.pk }}" aria-label="Delete">
            <span aria-hidden="true">Delete</span>
          </button></td>
        </tr>

        {% endfor %}
      </tbody>
  </table>
</div>
<div class="btn-group pt-3 mb-4" role="group" id="button-container">
</div>

{% endblock %}

{% block scripts %}
<script>
$(".delete-group").click(function () {
      if (confirm('Are you sure you want to delete this group?')) {
        var btn = $(this);
        var group = btn.data('group');
        var form = $('<form method="post">');
        form.append('{% csrf_token %}');
        form.append('<input name="group" value="' + group + '" />');
        form.append('<input name="request_type" value="delete_group" />');
        $('body').append(form);
        form.submit();
      }
      else {
        return false;
      }
      event.stopPropagation();
    });
</script
{% endblock %}